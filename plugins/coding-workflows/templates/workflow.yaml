# Coding Workflows Configuration
# Generated by /coding-workflows:init-config or created manually.
# See: https://github.com/Kiwi-Home/ai-coding-resources
#
# Schema version (for future migration support)
version: 1

# Project identity (auto-detected from git remote if omitted)
project:
  name: my-project          # Repository name
  org: my-org               # GitHub organization or username
  language: python           # Primary language: python, javascript, typescript, rust, go, ruby, java, elixir
  git_provider: github       # Only github is supported in v1
  # remote: origin            # Git remote that defines project identity (for issue/PR
                               # commands). Default: origin. Set when multiple remotes
                               # exist and a non-origin remote defines the project.
                               # Does NOT affect git push/pull/fetch targets.

# Build/test/lint commands
# Workflow commands use these instead of hardcoded tool invocations.
# If a command is omitted, the corresponding workflow step is skipped.
commands:
  test:
    # Focused test for a single file or path. Use {path} as placeholder.
    focused: "pytest {path} -v"
    # Full test suite
    full: "pytest"
  # Linter (auto-fix mode preferred)
  lint: "ruff check --fix ."
  # Type checker (omit if language doesn't have one)
  typecheck: "mypy ."
  # Branch naming pattern. {issue_num} and {description} are replaced at runtime.
  branch_pattern: "feature/{issue_num}-{description}"

# Planning configuration
planning:
  # Agent names to always include in planning sessions, regardless of domain matching.
  # These agents must exist in .claude/agents/. Leave empty for auto-discovery only.
  always_include: []
  # Files read before planning AND generation (/coding-workflows:generate-assets).
  # Generation commands extract conventions and patterns from these docs to pre-populate agents/skills.
  # Auto-discovered: CLAUDE.md, README.md are always read if present, even if not listed.
  reference_docs:
    - CLAUDE.md
    # Add project-specific docs (e.g., docs/architecture.md, docs/conventions.md)
  # Complexity triage for /coding-workflows:prepare-issue.
  # Controls how prepare-issue routes issues before design sessions.
  # 'auto' evaluates issue complexity using the complexity-triage skill.
  # Set to 'full' to disable auto-triage (always run full design session).
  triage:
    default_mode: auto      # auto | solo | lightweight | full

# Deliberation configuration (for /coding-workflows:design-session and multi-round dispatch)
deliberation:
  # Explicit conflict overrides between agent pairs.
  # Format: [{agent_a: "name", agent_b: "name", level: "HIGH"}]
  # When no overrides are configured, all conflicts default to LOW (single-round dispatch).
  conflict_overrides: []

# Hook behavior overrides
hooks:
  check_dependency_version:
    # mode: warn                  # "warn" (advisory, default) or "block" (denies the tool call)
    # package_managers:            # all supported if omitted; explicit list overrides
    #   - pip
    #   - npm
    # allowlist:                   # packages that skip the version check
    #   - setuptools
    #   - wheel
  pre_push_verification:
    # Max age for evidence before it's considered stale (default: 30)
    # staleness_threshold_minutes: 30
    # "block" (deny push, default) or "warn" (advisory only)
    # mode: block
  execute_issue_completion_gate:
    # escalation_threshold: 3     # Blocked-stop attempts before degrading to advisory (default: 3)
    review_gate: false             # Set true if using automated PR review (default: false)
  checkpoint_staleness:
    # threshold: 15               # Bash tool calls since last checkpoint before advisory fires (default: 15)
    # min_floor: 8                # Minimum total Bash calls before staleness detection activates (default: 8).
                                   # Suppresses the hook for short/simple sessions that complete quickly.

# --- Examples for other languages ---
#
# JavaScript/TypeScript:
#   commands:
#     test:
#       focused: "npx jest {path}"
#       full: "npm test"
#     lint: "npm run lint -- --fix"
#     typecheck: "npx tsc --noEmit"
#
# Rust:
#   commands:
#     test:
#       focused: "cargo test {path}"
#       full: "cargo test"
#     lint: "cargo clippy --fix"
#     # typecheck omitted (built into compiler)
#
# Go:
#   commands:
#     test:
#       focused: "go test {path}"
#       full: "go test ./..."
#     lint: "golangci-lint run --fix"
#     # typecheck omitted (built into compiler)
#
# Ruby:
#   commands:
#     test:
#       focused: "bundle exec ruby -Itest {path}"
#       full: "bundle exec rake test"
#     lint: "bundle exec rubocop -a"
#     # typecheck omitted (optional: sorbet)
